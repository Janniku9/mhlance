---
import { Icon } from 'astro-icon/components';
import { Icons } from '../../../types/Icons';
interface Props {
  class?: string;
}

const { class: className } = Astro.props;
---

<div
  id="mobile-drawer"
  class:list={[
    'fixed top-0 right-0 h-full w-64 bg-background-darker transform translate-x-full transition-transform duration-300 ease-in-out z-50',
    className,
  ]}
>
  <div class="p-4 space-y-6">
    <button
      id="close-drawer"
      class="absolute top-4 right-4 text-white hover:text-gray-300"
      aria-label="Close navigation menu"
    >
      <Icon name={Icons.close} size={24} />
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"
      ></path>
    </button>
  </div>
</div>

<div
  id="drawer-overlay"
  class="fixed inset-0 bg-black bg-opacity-50 opacity-0 pointer-events-none transition-opacity duration-300 z-40"
>
</div>

<script>
  const drawer = document.getElementById('mobile-drawer');
  const overlay = document.getElementById('drawer-overlay');
  const closeButton = document.getElementById('close-drawer');
  const openButton = document.getElementById('open-drawer');

  function openDrawer() {
    drawer?.classList.remove('translate-x-full');
    overlay?.classList.remove('opacity-0', 'pointer-events-none');
    document.body.style.overflow = 'hidden';
  }

  function closeDrawer() {
    drawer?.classList.add('translate-x-full');
    overlay?.classList.add('opacity-0', 'pointer-events-none');
    document.body.style.overflow = '';
  }

  openButton?.addEventListener('click', openDrawer);
  closeButton?.addEventListener('click', closeDrawer);
  overlay?.addEventListener('click', closeDrawer);

  // Close drawer on escape key
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') closeDrawer();
  });
</script>

<style>
  @media (prefers-reduced-motion: reduce) {
    #mobile-drawer,
    #drawer-overlay {
      transition: none;
    }
  }
</style>
