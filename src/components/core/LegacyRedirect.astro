---
// src/components/core/LegacyRedirect.astro
---

{
  /* This component is used to ensure old links on reddit/discord/etc. are redirected to the new page. */
  /* This is a client-side script, so it will not work on the server. */
}
<script>
  // legacy route mapping
  const legacyRoutes = {
    // rise
    '/builds/rise/low_rank': '/rise/builds/low-rank',
    '/builds/rise/high_rank': '/rise/builds/high-rank',
    '/builds/rise/master_rank': '/rise/builds/master-rank',
    '/builds/rise/post_story': '/rise/builds/post-story',
    '/builds/rise/end_game': '/rise/builds/endgame',

    '/guides/rise/combos': '/rise/guides/combos',
    '/guides/rise/switch_skills': '/rise/guides/switch-skills',
    '/guides/rise/dango': '/rise/guides/dango',
    '/guides/rise/palamutes': '/rise/guides/palamutes',
    '/guides/rise/followers': '/rise/guides/followers',

    '/info/rise/matchup': '/rise/data/match-ups',
    '/info/rise/guard_up': '/rise/data/guard-up',
    '/info/rise/anti_species': '/rise/data/anti-species',

    // world
    '/builds/world/low_rank': '/world/builds/low-rank',
    '/builds/world/high_rank': '/world/builds/high-rank',
    '/builds/world/master_rank': '/world/builds/master-rank',
    '/builds/world/post_story': '/world/builds/post-story',
    '/builds/world/end_game': '/world/builds/endgame',

    '/guides/world/guarding': '/world/guides/guarding',
    '/guides/world/combos': '/world/guides/combos',
    '/guides/world/clutch_claws': '/world/guides/clutch-claws',
    '/guides/world/mantles': '/world/guides/mantles',
    '/guides/world/palico': '/world/guides/palico',
    '/guides/world/food_skills': '/world/guides/food-skills',

    '/info/world/guard_up': '/world/data/guard-up',
  } as const;

  // redirect legacy route
  function redirectLegacyRoute() {
    const path = window.location.hash.replace('#', '');

    if (path && Object.prototype.hasOwnProperty.call(legacyRoutes, path)) {
      window.location.replace(legacyRoutes[path as keyof typeof legacyRoutes]);
    }
  }

  // Check on initial load
  redirectLegacyRoute();

  // Check on hash change
  window.addEventListener('hashchange', redirectLegacyRoute, { passive: true });
</script>
