---
import { Image } from 'astro:assets';
import { Icon } from 'astro-icon/components';
import BaseCard from '../common/BaseCard.astro';
import BaseCardTitle from '../common/BaseCardTitle.astro';
import BaseCardSubTitle from '../common/BaseCardSubTitle.astro';

interface Props {
  name: string;
  image: any;
  description: string[];
  cooldown?: string;
  duration?: string;
  effects?: string[];
  class?: string;
  reversed?: boolean;
  imageTargetWidth?: string;
  hoverable?: boolean;
  scaled?: boolean;
  href?: string;
  disabled?: boolean;
}

const {
  name,
  image,
  description,
  cooldown = '120s',
  duration = '90s',
  effects = [],
  class: className,
  reversed = false,
  imageTargetWidth = '200px',
  hoverable = true,
  scaled = true,
  href,
  disabled = false,
} = Astro.props;
---

<BaseCard
  class={className}
  hoverable={hoverable}
  scaled={scaled}
  href={href}
  disabled={disabled}
  dataAttribute="data-mantle-card-auto-hover"
>
  <div class="flex flex-col md:flex-row">
    <!-- Image Column (40%) -->
    <div
      class:list={[
        'p-4 sm:p-6 border-b md:border-b-0 md:border-r border-text/10 bg-secondary/5',
        'md:w-2/5' /* This creates the 40% width */,
        reversed ? 'md:order-2 md:border-l md:border-r-0' : 'md:order-1',
      ]}
    >
      <BaseCardTitle title={name} />

      <!-- Image -->
      <div class="flex justify-center mb-6">
        <div class="relative rounded-lg overflow-hidden" style={`width: ${imageTargetWidth};`}>
          <Image
            src={image}
            alt={`${name} mantle`}
            class="w-full h-auto transition-transform duration-300 group-hover:scale-105"
          />
        </div>
      </div>

      <!-- Stats -->
      <div class="grid grid-cols-1 gap-4 max-w-[200px] mx-auto">
        <div class="p-3 rounded-lg bg-text/5">
          <span class="text-sm text-text/60 block mb-1">COOLDOWN</span>
          <div class="flex items-center gap-2">
            <Icon name="mingcute:time-duration-fill" class="w-4 h-4 text-primary" />
            <span class="text-sm font-medium">{cooldown}</span>
          </div>
        </div>

        <div class="p-3 rounded-lg bg-text/5">
          <span class="text-sm text-text/60 block mb-1">DURATION</span>
          <div class="flex items-center gap-2">
            <Icon name="mingcute:time-fill" class="w-4 h-4 text-primary" />
            <span class="text-sm font-medium">{duration}</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Content Column (60%) -->
    <div
      class:list={[
        'p-6 md:p-8',
        'md:w-3/5' /* This creates the 60% width */,
        reversed ? 'md:order-1' : 'md:order-2',
      ]}
    >
      <!-- Description -->
      <div class="mb-6">
        <BaseCardSubTitle title="DESCRIPTION" class="mb-1" />
        {description.map((para) => <p class="text-sm text-text/80 mb-4 last:mb-0">{para}</p>)}

        <!-- Effects -->
        {
          effects.length > 0 && (
            <div class="mb-6">
              <BaseCardSubTitle title="EFFECTS" class="mb-2" />
              <ul class="space-y-2">
                {effects.map((effect) => (
                  <li class="text-sm text-text/80 flex items-start gap-2">
                    <Icon
                      name="mingcute:lightning-fill"
                      class="w-4 h-4 text-secondary flex-shrink-0"
                    />
                    {effect}
                  </li>
                ))}
              </ul>
            </div>
          )
        }

        <slot />
      </div>
    </div>
  </div>

  <script>
    import autoHoverDirective from '../../directives/auto-hover';
    document.querySelectorAll('[data-mantle-card-auto-hover]').forEach((element) => {
      if (element instanceof HTMLElement) autoHoverDirective(element);
    });
  </script>
</BaseCard>
